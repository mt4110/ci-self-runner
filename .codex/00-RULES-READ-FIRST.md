# Codex 運用ルール（必読）

## 絶対禁止（やったら差し戻し）
- リポジトリ名変更・勝手な rename
- `codex/` というディレクトリの作成（禁止）
- 勝手に巨大な新サブシステム追加（k8s/k9s、DB導入、監視基盤など）
- ルールを読まずに実装開始（この `.codex/` と `docs/ci/` を最初に読む）
- “便利そう”だけでツール増やす（依存は最小）

## 基本方針（バランス型）
- まず「設計→最小実装→計測→補正」の順で進める
- 変更範囲は常に小さく。1コミットでレビュー可能な量に抑える
- 既存ファイルの全文置換は避ける（差分最小）
- 大きい処理は分割する（時間・メモリが重いと察知したら分割/分散）
- ロジックは原則 Go に集約し、Shell は起動ラッパに限定する
- Shell に分岐・ループ・判定ロジックを書かない（詳細は `docs/ci/SHELL_POLICY.md`）

## 成果物の契約（このリポの目的）
- GitHub Actions の実行回数を減らす（PRは“最後”）
- Mac mini で決定論的検証（colima + docker で環境固定）
- GitHub は「証拠の置き場」(verify-only も最小限)

## セキュリティ最重要
- self-hosted runner で **外部/fork の PR を実行しない**
- 不特定入力のコードを runner 上で実行しない（原則: owner のみ）
